<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
	

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>

<script type="text/javascript">

	var count =0;

	function idCheck(){
		
		var text = $("#member_id").val();
		
        var regexp = /[0-9a-zA-Z]/; // 숫자,영문,특수문자
    							    // var regexp = /[0-9]/; // 숫자만
									// var regexp = /[a-zA-Z]/; // 영문만
        
        for(var i=0; i<text.length; i++){
            if(text.charAt(i) != " " && regexp.test(text.charAt(i)) == false ){
				alert("한글이나 특수문자는 입력이 불가능합니다.");
				return false;
			}
        }
        
        overlapCheck();
        
	}
	
	function overlapCheck(){
		
		var param = "member_id" + "=" + $("#member_id").val();
		if($("#member_id").val() == '' || $("#member_id").val()==null)
		{
			alert("아이디를 입력하세요");
			return false;
		}
		
		$.ajax({
			url : "/overlaptest.do",
			type : "GET",
			data : param,
			cache : false,
			async : false,
			dataType : "text",

			success : function(response) {				
				if(response=='0')
				{
					count = 1;
					alert("사용 가능한 아이디입니다.")
					
				}
				else
				{
					alert("이미 사용중인 아이디입니다.");
					return false;
				}	
			},
			error : function(request, status, error) {
				if (request.status != '0') {
					alert("code : " + request.status + "\r\nmessage : "
							+ request.reponseText + "\r\nerror : " + error);
				}
			}


		});
	}

	function formCheck() {
		var member_id = document.getElementById('member_id');
		var password = document.getElementById('password');
		var password_check = document.getElementById('password_check');
		
		
		
		if (member_id.value == '' || member_id.value == null) {
			alert('ID를 입력하세요');
			focus.member_id;
			return false;
		}

		if (password.value == '' || password.value == null) {
			alert('비밀번호를 입력하세요');
			focus.password;
			return false;
		}
		
		if (password_check.value == '' || password_check.value == null) {
			alert('비밀번호 확인란을 입력하세요');
			focus.password_hint;
			return false;
		}
		
		/*비밀번호와 비밀번호확인란 같은지 확인*/
		if (password.value != password_check.value){
			alert("비밀번호와 비밀번호 확인란이 다릅니다.");
			focus.passowrd;
			return false;
		}
		

		
		if(count == 0)
		{
			alert("중복 확인을 해주세요");
			return false;
		}
		
		else{
			save();
		}
		
	}
	
	
	function init(){
		count=0;
	}
	
	function save() {
// 		alert($("#password_hint").val());
// 		alert($("#member_HP").val());
		var str3 = document.getElementById('join');
		str3.submit();
		alert("가입이 완료되었습니다.")
	}
	
	function countCheck(){
		if(count==1){
			count=0;
		}
	}
</script>


<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>회원가입</title>
</head>
<body bgcolor="#ffffff" text="#000000">
	<P align="center">
		<FONT size="6"><B>회원 가입</B></FONT>
	</P>


	<form name = "regist" action="/app/regist" method="post" id="join">
		<table width="550" align="center" border="1" bordercolor="ADD8E6"
			cellpadding="5">
			<tr>
				<td height="30" align="center" bgcolor="#FFDEAD">아이디</td>
				<td bgcolor="#E0FFFF"><input type="text" size="10" id="member_id" name="uid" maxlength="10" onkeydown="countCheck();" onkeypress="countCheck();">&nbsp;<input type="button" value="중복확인" onclick='idCheck()'></td>
			</tr>
			<tr>
				<td height="30" align="center" bgcolor="#FFDEAD">비밀번호</td>
				<td bgcolor="#E0FFFF"><input type="password" id="password" name="upw" size=12 maxlength="12"></td>
			</tr>
			<tr>
				<td height="30" align="center" bgcolor="#FFDEAD">비밀번호 확인</td>
				<td bgcolor="#E0FFFF"><input type="password" id="password_check" name="upw_check" size=12 maxlength="12"></td>
			</tr>
		
			<tr>
				<td colspan="2" height="30" align="center" bgcolor="#FFDEAD">
				<input type="submit" id="join" name="regist" value="가입하기!" onclick="javascript:formCheck();">&nbsp;&nbsp;<input type="reset" value="리셋하기" onclick='init()'>
				<input type="button" id="back" value="뒤로가기" onclick="javascript:location.href='/loginpage.do';"></td>
			</tr>
		</table>
	</form>
</body>
</html>