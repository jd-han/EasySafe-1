<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace= "info.easysafe.mappers.MsgMapper">

	<select id="listAllSendMsg" parameterType="string" resultType="MsgVO">
		select *
		from tbl_msg
		where senduser = #{user}
		order by regdate desc
	</select>
	
	<select id="listAllReceiveMsg" parameterType="string" resultType="MsgVO">
		select *
		from tbl_msg
		where receiveuser = #{user}
		order by regdate desc
	</select>
	
	<select id="detailMsg" resultType="MsgVO">
		select *
		from tbl_msg
		where msgno = #{msgNo}
	</select>
	
	<insert id="sendMsg" parameterType="MsgVO">
		insert into tbl_msg (receiveuser, senduser, msg, msgtitle, readable)
		values (#{receiveUser}, #{sendUser}, #{msg}, #{msgTitle}, #{readable})
	</insert>
	
	<delete id="deleteMsg">
		delete from tbl_msg
		where msgno = #{msgNo}
	</delete>
	
	<update id="readMsg" parameterType="MsgVO">
		update tbl_msg		
		set readable = #{readable}
		where msgNo = #{msgNo}
	</update>
	<!-- MSG 부분에 있지만 유저 테이블을 조회한다.. 사실 원래 유저 컨트롤러에 있어야 하는건가? -->
	<select id="searchUser" parameterType="string" resultType="UserVO">
		select uid
		from tbl_user
		where uid = #{findId}
	</select>
	
</mapper>